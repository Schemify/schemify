# ğŸ› ï¸ 1. PreparaciÃ³n de ambiente

Este documento contiene los pasos necesarios para dejar listo el entorno de desarrollo del microservicio `__project_name_kebab__`.

## ğŸ“¦ 1. Instalar dependencias

Desde la raÃ­z del monorepo, ejecutar:

```bash
npm install
```

## âš™ï¸ 2. Configurar variables de entorno

### ğŸ“„ Archivo `docker/postgresql-__project_name_kebab__/.env.example`

Contiene las variables de entorno necesarias para levantar el contenedor de PostgreSQL.

```dotenv
# Variables de conexiÃ³n a PostgreSQL
__project_name_screaming___DATABASE_NAME=__project_name_camel__
__project_name_screaming___DATABASE_USER=__project_name_kebab___user
__project_name_screaming___DATABASE_PASSWORD=__project_name_kebab___password_secure
__project_name_screaming___DATABASE_PORT=5432
```

### ğŸ“„ Archivo `apps/__project_name_kebab__/.env.example`

Contiene la configuraciÃ³n de ejecuciÃ³n local del microservicio.

```dotenv
# ========================================
# CONFIGURACIÃ“N GLOBAL DEL PROYECTO
# ========================================

NODE_ENV=development
LOG_LEVEL=debug

# ========================================
# CONFIGURACIÃ“N DEL MICROSERVICIO __project_name_screaming__
# ========================================

SERVICE_APP_NAME=__project_name_camel__-service
__project_name_screaming___SERVICE_PORT=3000
__project_name_screaming___GRPC_PORT=50051

# ========================================
# CONFIGURACIÃ“N DE BASE DE DATOS __project_name_screaming__
# ========================================

__project_name_screaming___DATABASE_NAME=__project_name_camel__
__project_name_screaming___DATABASE_USER=__project_name_kebab___user
__project_name_screaming___DATABASE_PASSWORD=__project_name_kebab___password_secure
__project_name_screaming___DATABASE_PORT=5432
__project_name_screaming___DATABASE_HOST=postgres-__project_name_kebab__

__project_name_screaming___DATABASE_URL=postgresql://${__project_name_screaming___DATABASE_USER}:${__project_name_screaming___DATABASE_PASSWORD}@${__project_name_screaming___DATABASE_HOST}:5432/${__project_name_screaming___DATABASE_NAME}?schema=public

# ========================================
# CONFIGURACIÃ“N DE KAFKA
# ========================================

KAFKA_CLIENT_ID=__project_name_camel__-microservice
KAFKA_GROUP_ID=__project_name_camel__-group
KAFKA_BROKERS=kafka-1__project_name_kebab__:9092
```

> âš ï¸ Renombrar ambos archivos `.env.example` a `.env` y personalizar.



## ğŸ“Š 3. Crear topics Kafka por defecto

Ubicado en el script de inicializaciÃ³n Kafka:

```bash
docker/kafka-init/kafka-init-__project_name_kebab__.sh
```

### âœ¨ Script de creaciÃ³n de topics

```bash
#!/bin/bash

echo "â³ Waiting for Kafka to become ready..."

until kafka-topics --bootstrap-server kafka-1__project_name_kebab__:9092 --list > /dev/null 2>&1; do
  echo "â³ Kafka not ready, retrying..."
  sleep 5
done

echo "ğŸ“ Creating default topics for __project_name_kebab__..."

kafka-topics --create --topic __project_name_kebab__.created \
  --bootstrap-server kafka-1__project_name_kebab__:9092 \
  --partitions 1 \
  --replication-factor 1 \
  --if-not-exists

kafka-topics --create --topic __project_name_kebab__.description-updated \
  --bootstrap-server kafka-1__project_name_kebab__:9092 \
  --partitions 1 \
  --replication-factor 1 \
  --if-not-exists

echo "ğŸ“‹ Available topics:"
kafka-topics --list --bootstrap-server kafka-1__project_name_kebab__:9092

echo "âœ… Topics created successfully!"
```

> Para agregar nuevos topics, editar el mismo script repitiendo la instrucciÃ³n `kafka-topics --create ...`.


## ğŸ§¬ 4. Generar Prisma Client

Desde la raÃ­z del proyecto:

```bash
npm run prisma:generate
```

Este comando compila el `schema.prisma` y genera el cliente tipado de Prisma para usar en `infrastructure/prisma/`.


## ğŸ›°ï¸ 5. Compilar contratos gRPC

Ejecutar:

```bash
npm run proto:generate
```

Esto compilarÃ¡ los archivos `.proto` ubicados en `proto/`, y generarÃ¡ los DTOs y controladores tipados utilizando `ts-proto`.

---

âœ… Una vez completado este proceso, el microservicio estÃ¡ listo para ejecutarse en modo desarrollo o pruebas.
